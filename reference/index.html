
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Correlation-based feature selection of MD simulations.">
      
      
      
        <link rel="canonical" href="https://moldyn.github.io/MoSAIC/reference/">
      
      
        <link rel="prev" href="../faq/">
      
      
        <link rel="next" href="clustering/">
      
      
        
      
      
      <link rel="icon" href="../icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>mosaic - MoSAIC</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
  <!-- Load fonts from Google -->
  
  
  
  
  
  <link rel="stylesheet" href="../assets/external/fonts.googleapis.com/css.11a0ea6a.css">
  <style>
    :root {
      --md-text-font: "Source Sans Pro";
      --md-headline-font: "Playfair Display";
      --md-code-font: "Source Code Pro";
    }
  </style>
  

    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mosaic" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MoSAIC" class="md-header__button md-logo" aria-label="MoSAIC" data-md-component="logo">
      <!-- Logo -->

  <img id="logo_default_mode" src="../icon.png" alt="logo" />
  <img id="logo_slate_mode" src="../icon.png" alt="logo" />

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MoSAIC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              mosaic
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/moldyn/MoSAIC" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    moldyn/MoSAIC
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorial/t4l_tutorial_github/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Code Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../contributing/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://moldyn.uni-freiburg.de/" class="md-tabs__link">
        
  
  
    
  
  MolDyn Freiburg

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MoSAIC" class="md-nav__button md-logo" aria-label="MoSAIC" data-md-component="logo">
      <!-- Logo -->

  <img id="logo_default_mode" src="../icon.png" alt="logo" />
  <img id="logo_slate_mode" src="../icon.png" alt="logo" />

    </a>
    MoSAIC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/moldyn/MoSAIC" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    moldyn/MoSAIC
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/t4l_tutorial_github/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MoSAIC workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/cv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Crossvalidation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  
  <span class="md-ellipsis">
    
  
    mosaic
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    mosaic
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="clustering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    clustering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gridsearch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gridsearch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="similarity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    similarity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cli
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maintenance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Maintenance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://moldyn.uni-freiburg.de/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MolDyn Freiburg
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mosaic" class="md-nav__link">
    <span class="md-ellipsis">
      
        mosaic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mosaic.Clustering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clustering
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Clustering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mosaic.Clustering.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mosaic.Clustering.fit_predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit_predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mosaic.Clustering.score" class="md-nav__link">
    <span class="md-ellipsis">
      
        score
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mosaic.GridSearchCV" class="md-nav__link">
    <span class="md-ellipsis">
      
        GridSearchCV
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GridSearchCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mosaic.GridSearchCV.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mosaic.Similarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Similarity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Similarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mosaic.Similarity.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mosaic.Similarity.fit_transform" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit_transform
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mosaic.Similarity.transform" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
  

  
                  


  
  


  <h1>mosaic</h1>

<div class="doc doc-object doc-module">



<a id="mosaic"></a>
    <div class="doc doc-contents first">

        <p>MoSAIC is an advanced Python package specifically designed for the analysis of
discrete time series data from Molecular Dynamics (MD) simulations.
It offers a wide range of capabilities to identify collective coordinates that
describe the same biomolecular process.</p>
<p>With MoSAIC, researchers and engineers can easily analyze large and complex
datasets to gain insights into the underlying dynamics of biomolecular
processes. The package provides the capability to calculate various similarity
measures, such as linear correlation and mutual information, and to apply
different clustering algorithms to find groups of coordinates which move in a
concerted manner. By doing so, MoSAIC allows researchers and engineers to
identify groups of coordinates that collectively describe the same process in
MD simulations.</p>
<p>MoSAIC can be used as a stand-alone analysis tool or as a preprocessing step
for feature selection for subsequent Markov state modeling.
It is structured into the following submodules:</p>
<ul>
<li>
<p><a class="autorefs autorefs-internal" href="similarity/#mosaic.similarity"><strong>similarity</strong></a> This submodule introduces a versatile
class that enables the calculation of similarity measures based on different
correlation metrics. Users can choose from a set of popular metrics, such as
absolute value of Pearson correlation, of different normalizations of mutual
information. The result is always a similarity matrix,
which scales from 0 to 1. This submodule also supports efficient memory
management and flexible normalization options for mutual information-based
measures, making it a valuable addition to any data analysis pipeline.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="clustering/#mosaic.clustering"><strong>clustering</strong></a> This submodule is the most central
component of MoSAIC that offers various techniques for analyzing similarity
matrices. It provides different modes for clustering a correlation matrix,
including the Leiden algorithm with different objective functions
and linkage clustering, and supports both weighted and unweighted,
as well as full and sparse graphs.
The resulting clusters and labels can be accessed through the attributes of
the class.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="gridsearch/#mosaic.gridsearch"><strong>gridsearch</strong></a> This submodule provides a class for
performing grid search cross validation. It allows users to explore different
combinations of parameter settings for a clustering model and provides
evaluation metrics for each combination. The best combination of parameters
and the corresponding model can be easily retrieved using the provided
attributes.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="utils/#mosaic.utils"><strong>utils</strong></a> This submodule provides utility functions that can
be used to store and load the data or to provide runtume user information.</p>
</li>
</ul>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="mosaic.Clustering" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Clustering</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;CPM&#39;</span><span class="p">,</span> <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution_parameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mosaic.Clustering" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="sklearn.base.ClusterMixin">ClusterMixin</span></code>, <code><span title="sklearn.base.BaseEstimator">BaseEstimator</span></code></p>



        <p>Class for clustering a correlation matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>mode</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;CPM&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>the mode which determines the quality function optimized by the Leiden
algorithm ('CPM', or 'modularity') or linkage clustering.
- 'CPM': will use the constant Potts model on the full, weighted graph
- 'modularity': will use modularity on a knn-graph
- 'linkage': will use complete-linkage clustering</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>weighted</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the underlying graph has weighted edges. Otherwise, the graph
is constructed using the adjacency matrix.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_neighbors</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>This parameter specifies whether the whole matrix should be used, or
a knn-graph, which reduces the required memory.
The default depends on the <code>mode</code>
- 'CPM': <code>None</code> uses the full graph, and
- 'modularity': <code>None</code> uses square root of the number of features.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>resolution_parameter</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Required for mode 'CPM' and 'linkage'. If None, the resolution
parameter will be set to the third quartile of <code>X</code> for
<code>n_neighbors=None</code> and else to the mean value of the knn graph.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>seed</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Use an integer to make the randomness of Leidenalg deterministic. By
default uses a random seed if nothing is specified.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Clustering.clusters_">clusters_</span></code></b>
              (<code>ndarray of shape (n_clusters, )</code>)
          –
          <div class="doc-md-description">
            <p>The result of the clustering process. A list of arrays, each
containing all indices (features) corresponging to each cluster.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Clustering.labels_">labels_</span></code></b>
              (<code>ndarray of shape (n_features, )</code>)
          –
          <div class="doc-md-description">
            <p>Labels of each feature.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Clustering.matrix_">matrix_</span></code></b>
              (<code>ndarray of shape (n_features, n_features)</code>)
          –
          <div class="doc-md-description">
            <p>Permuted matrix according to the determined clusters.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Clustering.ticks_">ticks_</span></code></b>
              (<code>ndarray of shape (n_clusters, )</code>)
          –
          <div class="doc-md-description">
            <p>The cumulative number of features containing to the clusters.
May be used as ticks for plotting <code>matrix_</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Clustering.permutation_">permutation_</span></code></b>
              (<code>ndarray of shape (n_features, )</code>)
          –
          <div class="doc-md-description">
            <p>Permutation of the input features (corresponds to flattened
<code>clusters_</code>).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Clustering.n_neighbors_">n_neighbors_</span></code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Only avaiable when using knn graph. Indicates the number of nearest
neighbors used for constructin the knn-graph.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Clustering.resolution_param_">resolution_param_</span></code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Only for mode 'CPM' and 'linkage'. Indicates the resolution parameter
used for the CPM based Leiden clustering.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Clustering.linkage_matrix_">linkage_matrix_</span></code></b>
              (<code>ndarray of shape (n_clusters - 1, 4)</code>)
          –
          <div class="doc-md-description">
            <p>Only for mode 'linkage'. Contains the hierarchical clustering encoded
as a linkage matrix, see
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.linkage.html">scipy:spatial.distance.linkage</a>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">mosaic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clust</span> <span class="o">=</span> <span class="n">mosaic</span><span class="o">.</span><span class="n">Clustering</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clust</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="go">Clustering(resolution_parameter=0.7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clust</span><span class="o">.</span><span class="n">matrix_</span>
<span class="go">array([[1. , 0.9, 0.1],</span>
<span class="go">       [0.9, 1. , 0.1],</span>
<span class="go">       [0.1, 0.1, 1. ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clust</span><span class="o">.</span><span class="n">clusters_</span>
<span class="go">array([list([2, 0]), list([1])], dtype=object)</span>
</code></pre></div>

        <p>Initialize Clustering class.</p>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/mosaic/clustering.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">ClusteringModeString</span> <span class="o">=</span> <span class="s1">&#39;CPM&#39;</span><span class="p">,</span>
    <span class="n">weighted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_neighbors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PositiveInt</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution_parameter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumInRange0to1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize Clustering class.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span> <span class="n">ClusteringModeString</span> <span class="o">=</span> <span class="n">mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_neighbors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PositiveInt</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_neighbors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resolution_parameter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumInRange0to1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">resolution_parameter</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weighted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">weighted</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;linkage&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_neighbors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;mode=&#39;</span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&#39; does not support knn-graphs.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;CPM&#39;</span><span class="p">,</span> <span class="s1">&#39;linkage&#39;</span><span class="p">}:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">weighted</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;mode=&#39;</span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&#39; does not support weighted=False&quot;</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">resolution_parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;mode=&#39;</span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&#39; does not support the usage of the &quot;</span>
            <span class="s1">&#39;resolution_parameter&#39;</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="mosaic.Clustering.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mosaic.Clustering.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Clusters the correlation matrix by Leiden clustering on a graph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>X</code></b>
              (<code>ndarray of shape (n_features, n_features)</code>)
          –
          <div class="doc-md-description">
            <p>Matrix containing the correlation metric which is clustered. The
values should go from [0, 1] where 1 means completely correlated
and 0 no correlation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y</code></b>
              (<code><span title="Ignored">Ignored</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Not used, present for scikit API consistency by convention.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>self</code></b> (              <code><span title="object">object</span></code>
)          –
          <div class="doc-md-description">
            <p>Fitted estimator.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/mosaic/clustering.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">SimilarityMatrix</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clusters the correlation matrix by Leiden clustering on a graph.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : ndarray of shape (n_features, n_features)</span>
<span class="sd">        Matrix containing the correlation metric which is clustered. The</span>
<span class="sd">        values should go from [0, 1] where 1 means completely correlated</span>
<span class="sd">        and 0 no correlation.</span>
<span class="sd">    y : Ignored</span>
<span class="sd">        Not used, present for scikit API consistency by convention.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    self : object</span>
<span class="sd">        Fitted estimator.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>

    <span class="c1"># prepare matric for graph construction</span>
    <span class="n">mat</span><span class="p">:</span> <span class="n">FloatMatrix</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;linkage&#39;</span><span class="p">:</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;CPM&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_neighbors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_knn_mat</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;CPM&#39;</span><span class="p">,</span> <span class="s1">&#39;linkage&#39;</span><span class="p">}:</span>
        <span class="c1"># mask diagonal and zero elements</span>
        <span class="n">mat</span><span class="p">[</span><span class="n">mat</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">mat</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">mat</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution_parameter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_neighbors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">third_quartile</span> <span class="o">=</span> <span class="mf">0.75</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">resolution_parameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span>
                    <span class="n">mat</span><span class="p">,</span> <span class="n">third_quartile</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">resolution_parameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resolution_param_</span><span class="p">:</span> <span class="n">NumInRange0to1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resolution_parameter</span>
        <span class="p">)</span>

    <span class="c1"># create graph</span>
    <span class="n">mat</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mat</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">clusters</span><span class="p">:</span> <span class="n">Object1DArray</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;linkage&#39;</span><span class="p">:</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clustering_linkage</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># _mode in {&#39;CPM&#39;, &#39;modularity&#39;}</span>
        <span class="n">graph</span><span class="p">:</span> <span class="n">ig</span><span class="o">.</span><span class="n">Graph</span> <span class="o">=</span> <span class="n">ig</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">Weighted_Adjacency</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)),</span> <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clustering_leiden</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">clusters_</span><span class="p">:</span> <span class="n">Object1DArray</span> <span class="o">=</span> <span class="n">_sort_clusters</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">permutation_</span><span class="p">:</span> <span class="n">Index1DArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clusters_</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">matrix_</span><span class="p">:</span> <span class="n">Float2DArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">X</span><span class="p">)[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permutation_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">permutation_</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ticks_</span><span class="p">:</span> <span class="n">Index1DArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span>
        <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span> <span class="k">for</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clusters_</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Index1DArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permutation_</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clusters_</span><span class="p">):</span>
        <span class="n">labels</span><span class="p">[</span><span class="n">cluster</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels_</span><span class="p">:</span> <span class="n">Index1DArray</span> <span class="o">=</span> <span class="n">labels</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mosaic.Clustering.fit_predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mosaic.Clustering.fit_predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Clusters the correlation matrix by Leiden clustering on a graph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>X</code></b>
              (<code>ndarray of shape (n_features, n_features)</code>)
          –
          <div class="doc-md-description">
            <p>Matrix containing the correlation metric which is clustered. The
values should go from [0, 1] where 1 means completely correlated
and 0 no correlation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y</code></b>
              (<code><span title="Ignored">Ignored</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Not used, present for scikit API consistency by convention.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>labels</code></b> (              <code>ndarray of shape (n_samples,)</code>
)          –
          <div class="doc-md-description">
            <p>Cluster labels.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/mosaic/clustering.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit_predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">SimilarityMatrix</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Index1DArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clusters the correlation matrix by Leiden clustering on a graph.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : ndarray of shape (n_features, n_features)</span>
<span class="sd">        Matrix containing the correlation metric which is clustered. The</span>
<span class="sd">        values should go from [0, 1] where 1 means completely correlated</span>
<span class="sd">        and 0 no correlation.</span>
<span class="sd">    y : Ignored</span>
<span class="sd">        Not used, present for scikit API consistency by convention.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    labels : ndarray of shape (n_samples,)</span>
<span class="sd">        Cluster labels.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mosaic.Clustering.score" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mosaic.Clustering.score" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate silhouette_score of new correlation matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>X</code></b>
              (<code>ndarray of shape (n_features, n_features)</code>)
          –
          <div class="doc-md-description">
            <p>New matrix containing the correlation metric to score. The
values should go from [0, 1] where 1 means completely correlated
and 0 no correlation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y</code></b>
              (<code><span title="Ignored">Ignored</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Not used, present for scikit API consistency by convention.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>sample_weight</code></b>
              (<code><span title="beartype.typing.Optional">Optional</span>[<a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Not used, present for scikit API consistency by convention.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>score</code></b> (              <code><span title="float">float</span></code>
)          –
          <div class="doc-md-description">
            <p>Silhouette score of new correlation matrix based on fitted labels.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/mosaic/clustering.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">SimilarityMatrix</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Estimate silhouette_score of new correlation matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : ndarray of shape (n_features, n_features)</span>
<span class="sd">        New matrix containing the correlation metric to score. The</span>
<span class="sd">        values should go from [0, 1] where 1 means completely correlated</span>
<span class="sd">        and 0 no correlation.</span>
<span class="sd">    y : Ignored</span>
<span class="sd">        Not used, present for scikit API consistency by convention.</span>
<span class="sd">    sample_weight: Ignored</span>
<span class="sd">        Not used, present for scikit API consistency by convention.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    score : float</span>
<span class="sd">        Silhouette score of new correlation matrix based on fitted labels.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;labels_&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_&#39;</span><span class="p">])</span>

    <span class="n">n_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
    <span class="n">n_unique_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">n_labels</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Dimension of X d=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> needs to agree with the &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;dimension of the fitted data d=</span><span class="si">{</span><span class="n">n_labels</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">n_unique_labels</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_labels</span><span class="p">}:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mosaic.GridSearchCV" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">GridSearchCV</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">similarity</span><span class="p">,</span> <span class="n">clustering</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">gridsearch_kwargs</span><span class="o">=</span><span class="p">{})</span></code>

<a href="#mosaic.GridSearchCV" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="sklearn.model_selection.GridSearchCV">GridSearchCV</span></code></p>



        <p>Class for grid search cross validation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>similarity</code></b>
              (<code><a class="autorefs autorefs-internal" title="Similarity(*, metric='correlation', low_memory=False, normalize_method=None, use_knn_estimator=False) (mosaic.Similarity)" href="#mosaic.Similarity">Similarity</a></code>)
          –
          <div class="doc-md-description">
            <p>Similarity instance setup with constant parameters, see
<code>mosaic.Similarity</code> for available parameters. <code>low_memory</code> is not
supported.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>clustering</code></b>
              (<code><a class="autorefs autorefs-internal" title="Clustering(*, mode='CPM', weighted=True, n_neighbors=None, resolution_parameter=None, seed=None) (mosaic.Clustering)" href="#mosaic.Clustering">Clustering</a></code>)
          –
          <div class="doc-md-description">
            <p>Clustering instance setup with constant parameters, see
<code>mosaic.Clustering</code> for available parameters.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>param_grid</code></b>
              (<code><span title="dict">dict</span></code>)
          –
          <div class="doc-md-description">
            <p>Dictionary with parameters names (<code>str</code>) as keys and lists of
parameter settings to try as values, or list of such dictionaries,
in which case the grids spanned by each dictionary in the list are
explored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>gridsearch_kwargs</code></b>
              (<code><span title="dict">dict</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Dictionary with parameters to be used for
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html"><code>sklearn.model_selection.GridSearchCV</code></a>
class. The parameter <code>estimator</code> is not supported and <code>param_grid</code>
needs to be passed directly to the class.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.GridSearchCV.cv_results_">cv_results_</span></code></b>
              (<code>dict of numpy (masked) ndarrays</code>)
          –
          <div class="doc-md-description">
            <p>A dict with keys as column headers and values as columns.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.GridSearchCV.best_estimator_">best_estimator_</span></code></b>
              (<code><span title="estimator">estimator</span></code>)
          –
          <div class="doc-md-description">
            <p>Estimator that was chosen by the search, i.e. estimator
which gave highest score (or smallest loss if specified)
on the left out data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.GridSearchCV.best_score_">best_score_</span></code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>Mean cross-validated score of the best_estimator.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.GridSearchCV.best_params_">best_params_</span></code></b>
              (<code><span title="dict">dict</span></code>)
          –
          <div class="doc-md-description">
            <p>Parameter setting that gave the best results on the hold out data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.GridSearchCV.best_index_">best_index_</span></code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>The index (of the <code>cv_results_</code> arrays) which corresponds to the best
candidate parameter setting.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.GridSearchCV.n_splits_">n_splits_</span></code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>The number of cross-validation splits (folds/iterations).</p>
          </div>
        </li>
    </ul>


<details class="note" open>
  <summary>Notes</summary>
  <p>Check out
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">sklearn.model_selection.GridSearchCV</a>
for an overview of all available attributes and more detailed description.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">mosaic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create two correlated data sets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="n">func</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">for</span>  <span class="n">func</span> <span class="ow">in</span> <span class="p">(</span>
<span class="gp">... </span>        <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span>
<span class="gp">... </span>        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">,</span>
<span class="gp">... </span>        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">search</span> <span class="o">=</span> <span class="n">mosaic</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">similarity</span><span class="o">=</span><span class="n">mosaic</span><span class="o">.</span><span class="n">Similarity</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">clustering</span><span class="o">=</span><span class="n">mosaic</span><span class="o">.</span><span class="n">Clustering</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;resolution_parameter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="go">GridSearchCV(clustering=Clustering(),</span>
<span class="go">             param_grid={&#39;clust__resolution_parameter&#39;: [0.05, 0.2]},</span>
<span class="go">             similarity=Similarity())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">search</span><span class="o">.</span><span class="n">best_params_</span>
<span class="go">{&#39;clust__resolution_parameter&#39;: 0.2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">search</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="go">Pipeline(steps=[(&#39;sim&#39;, Similarity()),</span>
<span class="go">                (&#39;clust&#39;, Clustering(resolution_parameter=0.2))])</span>
</code></pre></div>

        <p>Initialize GridSearchCV class.</p>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/mosaic/gridsearch.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">similarity</span><span class="p">:</span> <span class="n">Similarity</span><span class="p">,</span>
    <span class="n">clustering</span><span class="p">:</span> <span class="n">Clustering</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="n">gridsearch_kwargs</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize GridSearchCV class.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">similarity</span><span class="p">:</span> <span class="n">Similarity</span> <span class="o">=</span> <span class="n">similarity</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clustering</span><span class="p">:</span> <span class="n">Clustering</span> <span class="o">=</span> <span class="n">clustering</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gridsearch_kwargs</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">gridsearch_kwargs</span>

    <span class="k">if</span> <span class="s1">&#39;estimator&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridsearch_kwargs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s1">&#39;Custom estimators are not supported. Please use the &#39;</span>
            <span class="s1">&#39;sklearn class GirdSearchCV directly.&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;param_grid&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridsearch_kwargs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Please pass &#39;param_grid&#39; directly to the the class.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">similarity</span><span class="o">.</span><span class="n">get_params</span><span class="p">()[</span><span class="s1">&#39;low_memory&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;&#39;low_memory&#39; is currently not implemented.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">param_grid</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;At least a single parameter needs to be provided&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sim_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity</span><span class="p">),</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_clust_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clustering</span><span class="p">),</span>
    <span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">param_grid</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">similarity</span><span class="o">.</span><span class="n">get_params</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">[</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_sim_prefix</span><span class="si">}</span><span class="s1">__</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">clustering</span><span class="o">.</span><span class="n">get_params</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">[</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_clust_prefix</span><span class="si">}</span><span class="s1">__</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;######################&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;param_grid key &#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&#39; is not available.&quot;</span>
            <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pipeline</span><span class="p">,</span>
        <span class="n">param_grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">,</span>
        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gridsearch_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="mosaic.GridSearchCV.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mosaic.GridSearchCV.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Clusters the correlation matrix by Leiden clustering on a graph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>X</code></b>
              (<code>ndarray of shape (n_samples, n_features)</code>)
          –
          <div class="doc-md-description">
            <p>Training vector, where <code>n_samples</code> is the number of samples and
<code>n_features</code> is the number of features.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y</code></b>
              (<code><span title="Ignored">Ignored</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Not used, present for scikit API consistency by convention.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>self</code></b> (              <code><span title="object">object</span></code>
)          –
          <div class="doc-md-description">
            <p>Fitted estimator.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/mosaic/gridsearch.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">FloatMax2DArray</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clusters the correlation matrix by Leiden clustering on a graph.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : ndarray of shape (n_samples, n_features)</span>
<span class="sd">        Training vector, where `n_samples` is the number of samples and</span>
<span class="sd">        `n_features` is the number of features.</span>
<span class="sd">    y : Ignored</span>
<span class="sd">        Not used, present for scikit API consistency by convention.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    self : object</span>
<span class="sd">        Fitted estimator.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mosaic.Similarity" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Similarity</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;correlation&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_knn_estimator</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#mosaic.Similarity" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="sklearn.base.BaseEstimator">BaseEstimator</span></code></p>



        <p>Class for calculating the similarity measure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>metric</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;correlation&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>the correlation metric to use for the feature distance matrix.
- <code>'correlation'</code> will use the absolute value of the Pearson
  correlation
- <code>'NMI'</code> will use the mutual information normalized by joined entropy
- <code>'GY'</code> uses Gel'fand and Yaglom normalization[^1]
- <code>'JSD'</code> will use the Jensen-Shannon divergence between the joint
  probability distribution and the product of the marginal probability
  distributions to calculate their dissimilarity
Note: <code>'NMI'</code> is supported only with low_memory=False</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>low_memory</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If True, the input of fit X needs to be a file name and the correlation
is calculated on the fly. Otherwise, an array is assumed as input X.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>normalize_method</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;geometric&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Only required for metric <code>'NMI'</code>. Determines the normalization factor
for the mutual information:
- <code>'joint'</code> is the joint entropy
- <code>'max'</code> is the maximum of the individual entropies
- <code>'arithmetic'</code> is the mean of the individual entropies
- <code>'geometric'</code> is the square root of the product of the individual
  entropies
- <code>'min'</code> is the minimum of the individual entropies</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>use_knn_estimator</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Can only be set for metric GY. If True, the mutual information
is estimated reliably by a parameter free method based on entropy
estimation from k-nearest neighbors distances[^3].
It considerably increases the computational time and is thus
only advisable for relatively small data-sets.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="mosaic.Similarity.matrix_">matrix_</span></code></b>
              (<code>ndarray of shape (n_features, n_features)</code>)
          –
          <div class="doc-md-description">
            <p>The correlation-measure-based pairwise distance matrix of the data. It
scales from [0, 1].</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">mosaic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">mosaic</span><span class="o">.</span><span class="n">Similarity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Similarity()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">matrix_</span>
<span class="go">array([[1.       , 0.9697832],</span>
<span class="go">       [0.9697832, 1.       ]])</span>
</code></pre></div>


<details class="note" open>
  <summary>Notes</summary>
  <p>The Pearson correlation coefficient is defined as</p>
<div class="arithmatex">\[\rho_{X,Y} =
\frac{\langle(X -\mu_X)(Y -\mu_Y)\rangle}{\sigma_X\sigma_Y}.\]</div>
<p>For the online (low memory) option the Welford algorithm<sup id="mosaic.Similarity--fnref:2"><a class="footnote-ref" href="#mosaic.Similarity--fn:2">2</a></sup> is used.</p>
<p>The Jensen-Shannon divergence is defined as</p>
<div class="arithmatex">\[D_{\text{JS}} = \frac{1}{2} D_{\text{KL}}(p(x,y)||M)
+ \frac{1}{2} D_{\text{KL}}(p(x)p(y)||M)\;,\]</div>
<p>where <span class="arithmatex">\(M = \frac{1}{2} [p(x,y) + p(x)p(y)]\)</span> is an averaged probability
distribution and <span class="arithmatex">\(D_{\text{KL}}\)</span> denotes the Kullback-Leibler divergence.</p>
<div class="footnote">
<hr />
<ol>
<li id="mosaic.Similarity--fn:1">
<p>Gel'fand, I.M. and Yaglom, A.M. (1957). "Calculation of amount of
information about a random function contained in another such
function".
American Mathematical Society Translations, series 2, 12, pp. 199–246.&#160;<a class="footnote-backref" href="#mosaic.Similarity--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="mosaic.Similarity--fn:2">
<p>Welford algorithm, generalized to correlation. Taken from:
Donald E. Knuth (1998). "The Art of Computer Programming", volume 2:
Seminumerical Algorithms, 3<sup>rd</sup> edn., p. 232. Boston: Addison-Wesley.&#160;<a class="footnote-backref" href="#mosaic.Similarity--fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="mosaic.Similarity--fn:3">
<p>B.C. Ross, PLoS ONE 9(2) (2014), "Mutual Information between Discrete
and Continuous Data Sets"&#160;<a class="footnote-backref" href="#mosaic.Similarity--fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>
</details>
        <p>Initialize Similarity class.</p>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/mosaic/similarity.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="n">MetricString</span> <span class="o">=</span> <span class="s1">&#39;correlation&#39;</span><span class="p">,</span>
    <span class="n">low_memory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">normalize_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NormString</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_knn_estimator</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize Similarity class.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">:</span> <span class="n">MetricString</span> <span class="o">=</span> <span class="n">metric</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">low_memory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">low_memory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_knn_estimator</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">use_knn_estimator</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;NMI&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">normalize_method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">normalize_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_normalize_method</span>
    <span class="k">elif</span> <span class="n">normalize_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s1">&#39;Normalize methods are only supported with metric=&quot;NMI&quot;&#39;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">normalize_method</span><span class="p">:</span> <span class="n">NormString</span> <span class="o">=</span> <span class="n">normalize_method</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric</span> <span class="o">!=</span> <span class="s1">&#39;GY&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_knn_estimator</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s1">&#39;The mutual information estimate based on k-nearest&#39;</span>
                <span class="s1">&#39;neighbors distances is only supported with metric=&quot;GY&quot;&#39;</span>
            <span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="mosaic.Similarity.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mosaic.Similarity.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the correlation/nmi distance matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>X</code></b>
              (<code>ndarray of shape (n_samples, n_features) or str if low_memory=True</code>)
          –
          <div class="doc-md-description">
            <p>Training data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y</code></b>
              (<code><span title="Ignored">Ignored</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Not used, present for scikit API consistency by convention.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>self</code></b> (              <code><span title="object">object</span></code>
)          –
          <div class="doc-md-description">
            <p>Fitted estimator.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/mosaic/similarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@singledispatchmethod</span>
<span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FloatMax2DArray</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLikeFloat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the correlation/nmi distance matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : ndarray of shape (n_samples, n_features) or str if low_memory=True</span>
<span class="sd">        Training data.</span>
<span class="sd">    y : Ignored</span>
<span class="sd">        Not used, present for scikit API consistency by convention.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    self : object</span>
<span class="sd">        Fitted estimator.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Fatal error, this should never be reached.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mosaic.Similarity.fit_transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mosaic.Similarity.fit_transform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the correlation/nmi distance matrix and returns it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>X</code></b>
              (<code>ndarray of shape (n_samples, n_features) or str if low_memory=True</code>)
          –
          <div class="doc-md-description">
            <p>Training data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>y</code></b>
              (<code><span title="Ignored">Ignored</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Not used, present for scikit API consistency by convention.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>Similarity</code></b> (              <code>ndarray of shape (n_features, n_features)</code>
)          –
          <div class="doc-md-description">
            <p>Similarity matrix.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/mosaic/similarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit_transform</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FloatMax2DArray</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLikeFloat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FloatMatrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the correlation/nmi distance matrix and returns it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : ndarray of shape (n_samples, n_features) or str if low_memory=True</span>
<span class="sd">        Training data.</span>
<span class="sd">    y : Ignored</span>
<span class="sd">        Not used, present for scikit API consistency by convention.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Similarity : ndarray of shape (n_features, n_features)</span>
<span class="sd">        Similarity matrix.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mosaic.Similarity.transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

<a href="#mosaic.Similarity.transform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the correlation/nmi distance matrix and returns it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>X</code></b>
              (<code>ndarray of shape (n_samples, n_features) or str if low_memory=True</code>)
          –
          <div class="doc-md-description">
            <p>Training data.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>Similarity</code></b> (              <code>ndarray of shape (n_features, n_features)</code>
)          –
          <div class="doc-md-description">
            <p>Similarity matrix.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/mosaic/similarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FloatMax2DArray</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FloatMatrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the correlation/nmi distance matrix and returns it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : ndarray of shape (n_samples, n_features) or str if low_memory=True</span>
<span class="sd">        Training data.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Similarity : ndarray of shape (n_features, n_features)</span>
<span class="sd">        Similarity matrix.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019-2023 Daniel Nagel and Georg Diez
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.moldyn.uni-freiburg.de" target="_blank" rel="noopener" title="www.moldyn.uni-freiburg.de" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M351.9 280H161c2.9 64.5 17.2 123.9 37.5 167.4 11.4 24.5 23.7 41.8 35.1 52.4 11.2 10.5 18.9 12.2 22.9 12.2s11.7-1.7 22.9-12.2c11.4-10.6 23.7-28 35.1-52.4 20.3-43.5 34.6-102.9 37.5-167.4zm-191-48h190.9c-2.8-64.5-17.1-123.9-37.4-167.4-11.4-24.4-23.7-41.8-35.1-52.4C268.1 1.7 260.4 0 256.4 0s-11.7 1.7-22.9 12.2c-11.4 10.6-23.7 28-35.1 52.4-20.3 43.5-34.6 102.9-37.5 167.4m-48 0c3.5-85.6 25.6-165.1 57.9-217.3C78.7 47.3 10.9 131.2 1.5 232zM1.5 280c9.4 100.8 77.2 184.7 169.3 217.3-32.3-52.2-54.4-131.7-57.9-217.3zm398.4 0c-3.5 85.6-25.6 165.1-57.9 217.3 92.1-32.7 159.9-116.5 169.3-217.3zm111.4-48C501.9 131.2 434.1 47.3 342 14.7c32.3 52.2 54.4 131.7 57.9 217.3z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/moldyn" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/MolDynFR" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="../https:/polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../assets/external/cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>